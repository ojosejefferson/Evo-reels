<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Swiper.js Reels Feed 100% Responsivo</title>
  
  <!-- Inclui os estilos do Swiper -->
  <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
  
  <style>
    /* Estilos base: Mobile First */
    * { margin:0; padding:0; box-sizing:border-box; }
    body, html { 
      height: 100%; 
      width: 100%;
      background: #000; 
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; 
      overflow: hidden;
    }
    
    /* 1. Container principal Swiper vertical (Mobile: 100% tela) */
    .vertical-swiper {
      width: 100%; 
      height: 100%; /* Usando 100% para melhor compatibilidade mobile */
      max-width: 100%;
      border-radius: 0; 
      box-shadow: none; 
      overflow: hidden;
      position: relative;
    }

    /* 2. Regra para Desktop: Simula√ß√£o de Celular (Acima de 450px) */
    @media (min-width: 450px) {
        body, html { 
            /* Centraliza o container na tela do desktop */
            display: flex; 
            align-items: center; 
            justify-content: center;
        }
        .vertical-swiper {
            width: 384px; /* Largura fixa do celular */
            height: 683px; /* Altura fixa do celular */
            max-width: 384px; 
            border-radius: 36px; /* Borda arredondada (simula√ß√£o) */
            box-shadow: 0 10px 40px rgba(0,0,0,0.7); /* Sombra (simula√ß√£o) */
        }
    }

    /* O container de cada "Reel" (Slide vertical) */
    .reel-container {
      width: 100%;
      height: 100%;
    }

    /* O Swiper horizontal dentro do slide vertical */
    .swiper-reel-horizontal {
      width: 100%;
      height: 100%;
      position: relative;
    }
    
    .swiper-slide video, .swiper-slide img { 
      width: 100%; height: 100%; object-fit: cover; 
    }
    
    /* Classes do Swiper para navega√ß√£o: .swiper-pagination-bullet */
    .swiper-pagination-horizontal.swiper-pagination-bullets {
        bottom: 140px; 
        display: flex;
        justify-content: center;
        gap: 9px;
        z-index: 25;
    }
    .swiper-pagination-bullet {
      width: 8px; height: 8px; background: rgba(255,255,255,0.5); 
      opacity: 1; 
      transition: all 0.3s;
    }
    .swiper-pagination-bullet-active {
      background: white; 
      transform: scale(1.5);
    }


    /* Seus estilos de Overlay e Controles (mantidos) */
    .video-progress {
      position: absolute; bottom: 9px; left: 20px; right: 20px;
      height: 3px; background: rgba(255,255,255,0.3); border-radius: 2px;
      z-index: 20; cursor: pointer;
    }
    .progress-fill {
      width: 0%; height: 100%; background: white; border-radius: 2px;
      transition: width 0.1s linear;
    }
    .play-pause-overlay {
      position: absolute; inset: 0; z-index: 5; cursor: pointer;
    }
    .play-pause-btn {
      position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
      width: 68px; height: 68px; background: rgba(0,0,0,0.6); backdrop-filter: blur(12px);
      border-radius: 50%; display: flex; align-items: center; justify-content: center;
      color: white; font-size: 28px; opacity: 0; transition: opacity 0.3s;
      pointer-events: none; z-index: 6;
    }
    .play-pause-btn.show { opacity: 1; }
    .top-controls {
      position: absolute; top: 16px; right: 16px; display: flex; gap: 12px; z-index: 30;
    }
    .control-btn {
      width: 40px; height: 40px; background: rgba(0,0,0,0.5); backdrop-filter: blur(10px);
      border-radius: 50%; display: flex; align-items: center; justify-content: center;
      color: white; font-size: 18px; cursor: pointer; border: none;
    }
    .overlay {
      position: absolute; inset: 0; padding: 20px; display: flex;
      flex-direction: column; justify-content: space-between;
      background: linear-gradient(to top, rgba(0,0,0,0.8) 0%, transparent 40%);
      color: white; pointer-events: none; z-index: 10;
    }
    .top h4 { font-size: 22px; font-weight: 600; pointer-events: auto; }
    .actions {
      position: absolute; right: 16px; bottom: 110px; display: flex;
      flex-direction: column; gap: 26px; pointer-events: auto; z-index: 25;
    }
    .btn {
      background: rgba(255,255,255,0.16); backdrop-filter: blur(12px);
      border: 1px solid rgba(255,255,255,0.2); width: 56px; height: 56px;
      border-radius: 50%; display: flex; align-items: center; justify-content: center;
      cursor: pointer;
    }
    .btn.buy {
      background: #fff; color: #000; font-weight: 700; font-size: 12px;
      border-radius: 18px; width: 68px; height: 52px;
    }
    .count { font-size: 12px; text-align: center; margin-top: 4px; }
    .footer { pointer-events: auto; cursor: pointer; z-index: 25; }
    .profile { display: flex; align-items: center; gap: 10px; margin-bottom: 6px; }
    .profile img { width: 36px; height: 36px; border-radius: 50%; border: 2px solid white; }
    .product-name { font-weight: 700; font-size: 16px; }
    .product-price { font-size: 14px; font-weight: 600; color: #00ff85; }
    .desc { font-size: 14px; line-height: 1.4; opacity: 0.9; margin-top: 4px; }

    /* Modal - Manter os estilos existentes */
    .modal {
      position: fixed; bottom: -100%; left: 50%; transform: translateX(-50%);
      width: 100%; 
      max-width: 384px; 
      max-height: 90vh; background: white; border-radius: 32px 32px 0 0;
      padding: 16px 20px 30px; transition: bottom 0.45s cubic-bezier(0.25,0.8,0.25,1);
      z-index: 999; box-shadow: 0 -10px 40px rgba(0,0,0,0.4); overflow-y: auto;
    }
    .modal.open { bottom: 0; }
    .back-btn { background:none; border:none; font-size:20px; cursor:pointer; padding:8px; font-weight:bold; }
    .drag-bar { width:40px; height:5px; background:#ddd; border-radius:3px; margin:8px auto 20px; }
    .modal-img { width:100%; height:340px; object-fit:cover; border-radius:20px; margin-bottom:16px; }
    .modal-title { font-size:22px; font-weight:700; margin-bottom:8px; }
    .modal-price { font-size:28px; font-weight:800; margin-bottom:12px; }
    .modal-desc { font-size:15px; line-height:1.5; color:#555; margin-bottom:30px; }
    .buy-btn { background:#000; color:white; border:none; padding:18px; border-radius:30px; font-size:18px; font-weight:700; width:100%; cursor:pointer; }

    /* ** Estilos de Zoom de Lupa ** */
    .slide-zoom img {
      transition: transform 0.4s ease;
      transform-origin: center center;
    }
    /* Desktop: Zoom ativado por HOVER (s√≥ funciona com mouse) */
    .slide-zoom:hover img {
        transform: scale(2.2);
    }
    /* Mobile: Classe de ativa√ß√£o para Duplo Toque/Pin√ßar */
    .slide-zoom.touch-zoom-active img {
      cursor: move; 
    }
    /* O scale ser√° definido via JS (inline style) para Pin√ßar */
    .slide-zoom.touch-zoom-active-fixed img {
        transform: scale(2.2); /* Fixed scale for double-tap */
    }
    .slide-zoom {
      cursor: crosshair;
    }

  </style>
</head>
<body>

  <!-- ** Swiper Vertical (Feed) ** -->
  <div class="swiper vertical-swiper" id="verticalSwiper">
    <div class="swiper-wrapper">
      
      <!-- ** Slide Vertical 1: O seu Reel original (agora Swiper Horizontal) ** -->
      <div class="swiper-slide reel-container" data-is-video="true">
        <div class="swiper swiper-reel-horizontal" id="reelSwiper1">
          <div class="swiper-wrapper">
            
            <!-- Slide Horizontal 1: V√≠deo -->
            <div class="swiper-slide video-slide">
              <video id="reelVideo1" autoplay loop playsinline preload="auto" muted>
                <source src="https://maksantos.com.br/wp-content/uploads/2024/12/VIDEO-MAKSANTOS-REELS-32-.mp4" type="video/mp4">
              </video>
              <div class="video-progress" id="videoProgress1">
                <div class="progress-fill" id="progressFill1"></div>
              </div>
              <div class="play-pause-overlay" id="videoOverlay1"></div>
              <div class="play-pause-btn" id="playPauseBtn1">Pause</div>
            </div>
            
            <!-- Slides Horizontal 2, 3, 4: Fotos com zoom lupa -->
            <div class="swiper-slide slide-zoom"><img src="https://agweb.co.in/fashion-hub/images/white-top-with-jacket.jpeg" alt="Foto 1"></div>
            <div class="swiper-slide slide-zoom"><img src="https://agweb.co.in/fashion-hub/images/white-top-with-jacket.jpeg" alt="Foto 2"></div>
            <div class="swiper-slide slide-zoom"><img src="https://agweb.co.in/fashion-hub/images/white-top-with-jacket.jpeg" alt="Foto 3"></div>
            
          </div>
          <!-- Pontinhos (Pagina√ß√£o Horizontal) -->
          <div class="swiper-pagination"></div>
        </div>
        
        <!-- Elementos de Overlay Comuns a TODOS os Slides (mantidos) -->
        <div class="top-controls">
          <button class="control-btn" id="soundBtn1" onclick="toggleSound(1)">Volume Off</button>
          <button class="control-btn">X</button>
        </div>
        <div class="overlay">
          <div class="top"><h4>Reels</h4></div>
          <div class="actions">
            <div><button class="btn buy">COMPRAR</button></div>
            <div><button class="btn">‚ù§Ô∏è</button><div class="count">8.2K</div></div>
            <div><button class="btn">üí¨</button><div class="count">655K</div></div>
            <div><button class="btn">üîó</button><div class="count">8.2K</div></div>
          </div>
          <div class="footer" onclick="openModal(1)">
            <div class="profile">
              <img src="https://agweb.co.in/images/portfolio/favicon/apple-icon-60x60.png" alt="">
              <div>
                <div class="product-name">Jaqueta Branca Premium</div>
                <div class="product-price">R$ 399,90</div>
              </div>
            </div>
            <div class="desc">Frete gr√°tis acima de R$299 ‚Ä¢ Edi√ß√£o limitada ‚Ä¢ Todo Brasil</div>
          </div>
        </div>
      </div>
      
      <!-- ** Slide Vertical 2: Novo Reel/Produto (Outro Swiper Horizontal) ** -->
      <div class="swiper-slide reel-container" data-is-video="false">
        <div class="swiper swiper-reel-horizontal" id="reelSwiper2">
          <div class="swiper-wrapper">
            
            <!-- Slides Horizontal: Apenas Imagens para o segundo produto -->
            <div class="swiper-slide slide-zoom"><img src="https://images.unsplash.com/photo-1542291026-7eec264c27fc?q=80&w=2670&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="T√™nis Vermelho"></div>
            <div class="swiper-slide slide-zoom"><img src="https://images.unsplash.com/photo-1605342415174-8d4ed0c5c364?q=80&w=2670&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="T√™nis Vermelho"></div>
            
          </div>
          <!-- Pontinhos (Pagina√ß√£o Horizontal) -->
          <div class="swiper-pagination"></div>
        </div>
        
        <!-- Elementos de Overlay Comuns a TODOS os Slides (mantidos) -->
        <div class="top-controls">
            <!-- Sem bot√£o de som, pois n√£o h√° v√≠deo -->
            <button class="control-btn">X</button>
        </div>
        <div class="overlay">
          <div class="top"><h4>Reels</h4></div>
          <div class="actions">
            <div><button class="btn buy">COMPRAR</button></div>
            <div><button class="btn">‚ù§Ô∏è</button><div class="count">12.5K</div></div>
            <div><button class="btn">üí¨</button><div class="count">980</div></div>
            <div><button class="btn">üîó</button><div class="count">5.1K</div></div>
          </div>
          <div class="footer" onclick="openModal(2)">
            <div class="profile">
              <img src="https://agweb.co.in/images/portfolio/favicon/apple-icon-60x60.png" alt="">
              <div>
                <div class="product-name">T√™nis Lifestyle Vermelho</div>
                <div class="product-price">R$ 559,99</div>
              </div>
            </div>
            <div class="desc">Design exclusivo ‚Ä¢ Lan√ßamento da cole√ß√£o outono/inverno.</div>
          </div>
        </div>
      </div>
      
    </div>
  </div>
  
  <!-- Modal 1 -->
  <div class="modal" id="modal1">
    <div style="display:flex; justify-content:space-between; align-items:center;">
      <button class="back-btn" onclick="closeModal()">‚úï</button>
    </div>
    <div class="drag-bar"></div>
    <img src="https://agweb.co.in/fashion-hub/images/white-top-with-jacket.jpeg" class="modal-img" alt="Jaqueta">
    <h3 class="modal-title">Jaqueta Branca Premium</h3>
    <div class="modal-price">R$ 399,90</div>
    <p class="modal-desc">Tecido premium italiano, acabamento perfeito. Frete gr√°tis acima de R$299 ‚Ä¢ Parcelamento em at√© 12x.</p>
    <button class="buy-btn">COMPRAR AGORA</button>
  </div>

  <!-- Modal 2 (Novo) -->
  <div class="modal" id="modal2">
    <div style="display:flex; justify-content:space-between; align-items:center;">
      <button class="back-btn" onclick="closeModal()">‚úï</button>
    </div>
    <div class="drag-bar"></div>
    <img src="https://images.unsplash.com/photo-1542291026-7eec264c27fc?q=80&w=2670&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" class="modal-img" alt="T√™nis">
    <h3 class="modal-title">T√™nis Lifestyle Vermelho</h3>
    <div class="modal-price">R$ 559,99</div>
    <p class="modal-desc">Lan√ßamento da cole√ß√£o, solado com tecnologia de amortecimento e design moderno. Leve o estilo para onde for!</p>
    <button class="buy-btn">COMPRAR AGORA</button>
  </div>

  <!-- Inclui o script do Swiper -->
  <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
  
  <script>
    // ** Vari√°veis Globais **
    const video = document.getElementById('reelVideo1');
    const progressFill = document.getElementById('progressFill1');
    const videoOverlay = document.getElementById('videoOverlay1');
    const playPauseBtn = document.getElementById('playPauseBtn1');
    const soundBtn = document.getElementById('soundBtn1');
    
    // ** 1. Configura√ß√£o do Swiper Vertical (Feed de Reels) **
    const verticalSwiper = new Swiper('#verticalSwiper', {
      direction: 'vertical',
      slidesPerView: 1,
      spaceBetween: 0,
      mousewheel: true,
      keyboard: { enabled: true },
      on: {
        slideChangeTransitionStart: function() {
          if (this.previousIndex === 0) {
            video.pause();
          }
        },
        slideChangeTransitionEnd: function() {
          if (this.activeIndex === 0) {
            video.currentTime = 0;
            video.play();
            video.muted = (soundBtn.textContent === "Volume Off");
          }
          const currentHorizontalSwiper = this.slides[this.activeIndex].querySelector('.swiper-reel-horizontal').swiper;
          if (currentHorizontalSwiper) {
             currentHorizontalSwiper.slideTo(0);
          }
        },
      }
    });

    // ** 2. Configura√ß√£o do Swiper Horizontal (Imagens/V√≠deos de um Reel) **
    document.querySelectorAll('.swiper-reel-horizontal').forEach(function(element) {
      new Swiper(element, {
        slidesPerView: 1,
        spaceBetween: 0,
        pagination: {
          el: element.querySelector(".swiper-pagination"),
          clickable: true,
        },
        keyboard: { enabled: true },
        on: {
          slideChange: function() {
            if (verticalSwiper.activeIndex === 0) {
              if (this.activeIndex === 0) {
                video.currentTime = 0;
                video.play();
              } else {
                video.pause();
              }
            }
            
            // NOVO: Resetar o zoom ao mudar de slide horizontal (Bug de persist√™ncia)
            const prevSlide = this.slides[this.previousIndex];
            if (prevSlide && prevSlide.classList.contains('slide-zoom') && (prevSlide.classList.contains('touch-zoom-active-fixed') || prevSlide.classList.contains('touch-zoom-active'))) {
                 resetZoom(prevSlide); // Desativa o zoom e reseta a escala
            }
          }
        }
      });
    });

    // ** 3. L√≥gica do V√≠deo **
    video.muted = true;
    video.play().catch(e => console.log("O v√≠deo n√£o p√¥de ser reproduzido automaticamente."));

    video.addEventListener('timeupdate', () => {
      if (video.duration) {
        progressFill.style.width = (video.currentTime / video.duration) * 100 + '%';
      }
    });

    videoOverlay.addEventListener('click', (e) => {
      e.stopPropagation();
      if (video.paused) {
        video.play();
        playPauseBtn.textContent = 'Pause';
      } else {
        video.pause();
        playPauseBtn.textContent = 'Play';
      }
      playPauseBtn.classList.add('show');
      setTimeout(() => playPauseBtn.classList.remove('show'), 800);
    });

    // Controle de Som
    function toggleSound(id) {
        const targetVideo = document.getElementById('reelVideo' + id);
        const targetBtn = document.getElementById('soundBtn' + id);
        if (targetVideo) {
            targetVideo.muted = !targetVideo.muted;
            targetBtn.textContent = targetVideo.muted ? "Volume Off" : "Volume On";
        }
    }
    window.toggleSound = toggleSound;

    // ** 4. L√≥gica do Zoom (Pin√ßar e Duplo Toque) **
    
    const touchTimestamps = new WeakMap();
    const doubleTapDelay = 300; 

    // Vari√°veis para Pin√ßar (Pinch-to-Zoom)
    let initialPinchDistance = 0;
    let currentScale = 1;
    let imgElement = null;

    function getDistance(touch1, touch2) {
        return Math.sqrt(
            Math.pow(touch2.clientX - touch1.clientX, 2) +
            Math.pow(touch2.clientY - touch1.clientY, 2)
        );
    }
    
    // Fun√ß√£o universal para resetar o zoom (chamada por Duplo Toque OFF ou Slide Change)
    function resetZoom(parentSlide) {
        const img = parentSlide.querySelector('img');
        
        // Remove todas as classes de zoom
        parentSlide.classList.remove('touch-zoom-active', 'touch-zoom-active-fixed', 'swiper-no-swiping');
        
        // Reseta o estilo inline de transform (para Pin√ßar)
        img.style.transform = 'scale(1)'; 
        
        // Reseta o ponto de origem e remove listener de pan
        img.style.transformOrigin = 'center center';
        parentSlide.removeEventListener('touchmove', handleZoomPan, { passive: false });
        
        // Reseta vari√°veis do pinch
        currentScale = 1;
        initialPinchDistance = 0;
        imgElement = null;
    }

    // Fun√ß√£o para Ligar/Desligar o zoom de Duplo Toque (Fixo 2.2x)
    function toggleZoom(parentSlide) {
        if (window.innerWidth >= 450) return; 

        const isZoomActive = parentSlide.classList.toggle('touch-zoom-active-fixed');
        const img = parentSlide.querySelector('img');

        if (isZoomActive) {
            // ZOOM ON: Desativa o deslize e habilita o Pan (handleZoomPan √© o mesmo para toque simples no zoom)
            parentSlide.classList.add('touch-zoom-active'); // Adiciona a classe gen√©rica
            parentSlide.classList.add('swiper-no-swiping');
            parentSlide.addEventListener('touchmove', handleZoomPan, { passive: false });
            // Aplica a escala fixa
            img.style.transform = 'scale(2.2)';

        } else {
            // ZOOM OFF: Reseta completamente
            resetZoom(parentSlide);
        }
    }

    // Fun√ß√£o para mover o ponto de origem (pan) no zoom (usado por Duplo Toque)
    function handleZoomPan(e) {
        if (e.touches.length !== 1 || (!e.currentTarget.classList.contains('touch-zoom-active-fixed') && !e.currentTarget.classList.contains('touch-zoom-active'))) return;

        e.preventDefault(); 
        e.stopPropagation();

        const parentSlide = e.currentTarget;
        const img = parentSlide.querySelector('img');
        const touch = e.touches[0];
        const rect = img.getBoundingClientRect();
        const x = touch.clientX - rect.left;
        const y = touch.clientY - rect.top;
        const xPercent = (x / rect.width) * 100;
        const yPercent = (y / rect.height) * 100;
        
        // Move o centro da transforma√ß√£o (origem) para a posi√ß√£o do toque
        img.style.transformOrigin = `${xPercent}% ${yPercent}%`;
    }


    document.querySelectorAll('.slide-zoom').forEach(slide => {
        // ----------------------------------------------------
        // GESTOS MOBILE (Duplo Toque, Pin√ßar)
        // ----------------------------------------------------
        slide.addEventListener('touchstart', (e) => {
            if (window.innerWidth >= 450) return; // Ignora Desktop

            if (e.touches.length === 2) {
                // ** Pin√ßar (Pinch-to-Zoom) - In√≠cio **
                e.preventDefault();
                resetZoom(slide); // Desativa zoom de duplo toque se estiver ativo
                
                initialPinchDistance = getDistance(e.touches[0], e.touches[1]);
                currentScale = 1; 
                imgElement = slide.querySelector('img');

                slide.classList.add('touch-zoom-active', 'swiper-no-swiping');
                
            } else if (e.touches.length === 1) {
                // ** Duplo Toque - Detec√ß√£o **
                const lastTapTime = touchTimestamps.get(slide) || 0;
                const currentTime = new Date().getTime();

                if (currentTime - lastTapTime < doubleTapDelay) {
                    e.preventDefault(); 
                    e.stopPropagation(); 
                    
                    toggleZoom(slide);
                    touchTimestamps.set(slide, 0); // Reseta o timer

                    // Define o ponto inicial de zoom no centro do toque duplo
                    const touch = e.touches[0];
                    const img = slide.querySelector('img');
                    const rect = img.getBoundingClientRect();
                    const x = touch.clientX - rect.left;
                    const y = touch.clientY - rect.top;
                    const xPercent = (x / rect.width) * 100;
                    const yPercent = (y / rect.height) * 100;
                    img.style.transformOrigin = `${xPercent}% ${yPercent}%`;
                } else {
                    touchTimestamps.set(slide, currentTime);
                }
            }
        }, { passive: false }); 

        slide.addEventListener('touchmove', (e) => {
            if (window.innerWidth >= 450) return; // Ignora Desktop

            if (e.touches.length === 2 && initialPinchDistance > 0) {
                // ** Pin√ßar (Pinch-to-Zoom) - Movimento **
                e.preventDefault(); 
                e.stopPropagation();

                const newDistance = getDistance(e.touches[0], e.touches[1]);
                // Calcula a nova escala com um limite de zoom m√°ximo
                let scaleChange = newDistance / initialPinchDistance;
                let newScale = Math.max(1, Math.min(scaleChange, 4)); // Escala entre 1x e 4x

                // Aplica a escala e o pan (origem no centro da pin√ßa)
                if (imgElement) {
                    imgElement.style.transform = `scale(${newScale})`;
                    
                    // Calcula o ponto m√©dio (centro da pin√ßa) para o transformOrigin
                    const centerX = (e.touches[0].clientX + e.touches[1].clientX) / 2;
                    const centerY = (e.touches[0].clientY + e.touches[1].clientY) / 2;
                    
                    const rect = imgElement.getBoundingClientRect();
                    const x = centerX - rect.left;
                    const y = centerY - rect.top;
                    const xPercent = (x / rect.width) * 100;
                    const yPercent = (y / rect.height) * 100;
                    imgElement.style.transformOrigin = `${xPercent}% ${yPercent}%`;
                }
                
                currentScale = newScale;

            } else if (e.touches.length === 1 && (slide.classList.contains('touch-zoom-active-fixed') || slide.classList.contains('touch-zoom-active'))) {
                // O pan √© tratado pela fun√ß√£o handleZoomPan, mas precisa da classe de ativa√ß√£o
                handleZoomPan(e); 
            }
        }, { passive: false });

        slide.addEventListener('touchend', (e) => {
            if (window.innerWidth >= 450) return; // Ignora Desktop

            // Se a escala for pr√≥xima de 1 ap√≥s o pin√ßar, reseta completamente
            if (currentScale < 1.1) {
                resetZoom(slide);
            }
            
            // Reseta vari√°veis do pinch (importante para evitar ativa√ß√£o acidental)
            initialPinchDistance = 0;
            imgElement = null;

        });


        // ----------------------------------------------------
        // DESKTOP ZOOM (Hover/MouseMove)
        // ----------------------------------------------------
        slide.addEventListener('mousemove', (e) => {
            if (window.innerWidth >= 450) { // S√ì desktop
                // Aplica o transform-origin baseado na posi√ß√£o do mouse (pan/lupa)
                const img = e.currentTarget.querySelector('img');
                const rect = img.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                const xPercent = (x / rect.width) * 100;
                const yPercent = (y / rect.height) * 100;
                img.style.transformOrigin = `${xPercent}% ${yPercent}%`;
            }
        });

        slide.addEventListener('mouseleave', (e) => {
            if (window.innerWidth >= 450) { // S√ì desktop
                 // Reseta o transform-origin ao sair (o CSS cuida do transform: scale(1))
                 e.currentTarget.querySelector('img').style.transformOrigin = 'center center';
            }
        });
    });
    
    // ** 5. L√≥gica do Modal **
    function openModal(id) { 
        document.getElementById('modal' + id).classList.add('open'); 
    }
    function closeModal() { 
        document.getElementById('modal1').classList.remove('open'); 
        document.getElementById('modal2').classList.remove('open'); 
    }

    document.getElementById('modal1').addEventListener('click', e => { if(e.target === e.currentTarget) closeModal(); });
    document.getElementById('modal2').addEventListener('click', e => { if(e.target === e.currentTarget) closeModal(); });

    window.openModal = openModal;
    window.closeModal = closeModal;
  </script>
</body>
</html>
